!function(e,t){for(var n in t)e[n]=t[n]}(window,function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/static/assets/bundles/",n(n.s=146)}({1:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function a(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=new l(e,n);return i.createDropdown(t),i}n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return l}));var l=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];i(this,e),this.originalSelect=document.getElementById(t),this.options=Array.from(this.originalSelect.children),this.allowMultiple=n}var t,n,a;return t=e,(n=[{key:"createDropdown",value:function(e){var t=this,n=document.createElement("div");n.classList.add("dropdown-select","wide"),n.tabIndex=0;var i=document.createElement("span");i.classList.add("current"),i.textContent=this.options[0].textContent,n.appendChild(i);var r=document.createElement("div");r.classList.add("list");var a=document.createElement("div");a.classList.add("dd-search");var l=document.createElement("input");l.type="text",l.id="txtSearchValue",l.placeholder=e,l.classList.add("dd-searchbox"),l.autocomplete="off",l.onkeyup=function(){return t._filter()},this.searchBoxInput=l;var s=document.createElement("ul");this.searchBoxOptions=s,this._addItemsToList(this.options),a.appendChild(l),r.appendChild(a),r.appendChild(s),n.appendChild(r),this.newSelect=n,this.originalSelect.parentElement.appendChild(n),this.originalSelect.style.display="none",this._addOpenCloseListener(),this._addClickOutsideListener(),this._addOptionClickListener(),this._addKeysListener()}},{key:"_addItemsToList",value:function(e){var t=this;e.forEach((function(e,n){return t._addItemToList(e,n)})),this.allowMultiple||this.searchBoxOptions.firstElementChild.classList.add("selected")}},{key:"_addItemToList",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=document.createElement("li");if(i.classList.add("option"),i.index,i.dataset.value=t,this.allowMultiple){var r=document.createElement("div");r.classList.add("multiple-select-item-container");var a=document.createElement("p");a.textContent=e.textContent,r.appendChild(a);var l=document.createElement("label"),s=document.createElement("input");l.classList.add("checkbox"),l.classList.add("checkbox-option"),s.classList.add("checkbox-option"),s.type="checkbox",n&&(i.classList.add("selected"),s.checked=!0),l.appendChild(s),r.append(l),i.appendChild(r)}else i.textContent=e.textContent;this.searchBoxOptions.appendChild(i)}},{key:"_filter",value:function(){var e=this;Array.from(this.searchBoxOptions.children).forEach((function(t){t.textContent.toLowerCase().includes(e.searchBoxInput.value)?t.style.display="block":t.style.display="none"}))}},{key:"_addOpenCloseListener",value:function(){var e=this;this.newSelect.addEventListener("click",(function(t){var n=t.target.classList,i=t.target.parentElement.classList;if(i.contains("open")||i.contains("multiple-select-item-container"))return e._removeTabIndex(),void(e.allowMultiple||e.newSelect.classList.remove("open"));n.contains("dd-searchbox")||n.contains("checkbox-option")||"UL"===t.target.tagName||(e.newSelect.classList.toggle("open"),Array.from(e.searchBoxOptions.children).forEach((function(e){return e.tabIndex=0})),e.searchBoxInput.focus())}))}},{key:"_addClickOutsideListener",value:function(){var e=this;document.addEventListener("click",(function(t){for(var n=t.target;"HTML"!==(n=n.parentElement).tagName;)if(Array.from(n.classList).includes("dropdown-select")&&e.allowMultiple)return;Array.from(t.target.classList).includes("dropdown-select")||(e.newSelect.classList.remove("open"),e.newSelect.removeAttribute("tabindex"),e._removeTabIndex()),t.stopPropagation()}))}},{key:"_removeTabIndex",value:function(){Array.from(this.searchBoxOptions.children).forEach((function(e){return e.removeAttribute("tabindex")}))}},{key:"_addOptionClickListener",value:function(){var e=this;this.newSelect.addEventListener("click",(function(t){var n=t.target;if(e._isValidNewSelectOption(n))if(e.allowMultiple){for(var i="INPUT"===n.tagName;"LI"!==n.tagName;)n=n.parentElement;var r=n.children[0].children[1].children[0];i||(r.checked^=1),r.checked?n.classList.add("selected"):n.classList.remove("selected"),e.originalSelect.children[n.dataset.value].selected=r.checked;var a=main.getSelectValues(e.originalSelect).join(", ");e.newSelect.firstChild.textContent=a||"None"}else Array.from(e.searchBoxOptions.children).forEach((function(e){return e.classList.remove("selected")})),n.classList.add("selected"),e.newSelect.firstChild.textContent=n.textContent,e.originalSelect.value=e.originalSelect.children[n.dataset.value].value}))}},{key:"_isValidNewSelectOption",value:function(e){return!(e.classList.contains("dropdown-select")||e.classList.contains("dd-searchbox")||"UL"===e.tagName||"SPAN"===e.tagName||e.classList.contains("list"))}},{key:"_addKeysListener",value:function(){var e=this;this.newSelect.addEventListener("keydown",(function(t){if(e.newSelect.classList.contains("open")){var n=t.target;13===t.keyCode?n.click():27===t.keyCode?e.newSelect.click():37===t.keyCode&&n.prevSibling?n.prevSibling.focus():40===t.keyCode&&n.nextSibling&&n.nextSibling.focus()}}))}},{key:"addOption",value:function(e){if(""!==e){e=e.toLowerCase();var t=document.createElement("option");t.value=e,t.innerHTML=e.capitalize(),t.selected=!0,this.originalSelect.appendChild(t),this._addItemToList(t,this.newSelect.children[1].children[1].childElementCount,!0)}}}])&&r(t.prototype,n),a&&r(t,a),e}()},146:function(e,t,n){e.exports=n(154)},154:function(e,t,n){"use strict";n.r(t);var i=n(1);function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function l(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}var s=function(){function e(t,n,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;r(this,e),this.workFunc=this._updateTimer,this.interval=n,this.errorFunc=a,this.timesUpFunc=i,this.timeComponents={hour:t.hour,minutes:t.minutes,seconds:t.seconds},this.sound=new Howl({src:"/sounds/sos.mp3",loop:!0})}return l(e,[{key:"start",value:function(e){this.time=e,this.originalTime=e,this.expected=Date.now()+this.interval,this.timeout=setTimeout(this.step.bind(this),this.interval),this.workFunc()}},{key:"stop",value:function(){clearTimeout(this.timeout),this._restoreTime(),this.sound.stop()}},{key:"step",value:function(){if(0==this.time)return this.sound.play(),void this.timesUpFunc();var e=Date.now()-this.expected;this.errorFunc&&e>this.interval&&this.errorFunc(),this.time--,this.workFunc(),this.expected+=this.interval,this.timeout=setTimeout(this.step.bind(this),Math.max(0,this.interval-e))}},{key:"_updateTimer",value:function(){var e=this._separateTime(this.time);this._updateTimeComponents(e)}},{key:"_restoreTime",value:function(){var e=this._separateTime(this.originalTime);this._updateTimeComponents(e)}},{key:"_separateTime",value:function(e){var t=Math.floor(e/3600),n=3600*t,i=Math.floor(Math.abs(n-e)/60);return{hours:t,minutes:i,seconds:e-n-60*i}}},{key:"_updateTimeComponents",value:function(e){this.timeComponents.hour.textContent=e.hours,this.timeComponents.minutes.textContent=e.minutes,this.timeComponents.seconds.textContent=e.seconds}}]),e}(),o=function(){function e(){var t=this;r(this,e),this._ctx=new AudioContext,this._soundBeatOne=new Howl({src:"/sounds/one.wav"}),this._soundBeatOther=new Howl({src:"/sounds/other.wav"}),this._soundBeatBetween=new Howl({src:"/sounds/between.wav"}),this._lastBar=0,this._lastBeat=0,this._metronome=window.MusicalTimer((function(){"running"!==t._ctx.state&&t._ctx.resume(),t._lastBar!==t._metronome.bar&&(t._lastBar=t._metronome.bar,t._beep(t._soundBeatOne)),t._lastBeat!==t._metronome.beat?(t._lastBeat=t._metronome.beat,t._beep(t._soundBeatBetween)):t._beep(t._soundBeatOther)}))}return l(e,[{key:"_beep",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.play();try{this._signatureVisual.children[this._metronome.beat-2].classList.remove("highlightBeat"),this._signatureVisual.children[this._metronome.beat-2].classList.remove("highlightBeat1"),this._signatureVisual.children[this._metronome.beat-1].classList.add("highlightBeat")}catch(e){this._signatureVisual.lastElementChild.classList.remove("highlightBeat"),this._signatureVisual.children[this._metronome.beat-1].classList.add("highlightBeat1")}this._barNumberElement.value=this._metronome.bar}},{key:"play",value:function(){this._metronome.play()}},{key:"pause",value:function(){this._metronome.pause()}},{key:"stop",value:function(){try{this._signatureVisual.children[this._metronome.beat-1].classList.remove("highlightBeat"),this._signatureVisual.children[this._metronome.beat-1].classList.remove("highlightBeat1")}finally{this._barNumberElement.value=1,this._metronome.stop()}}},{key:"setTempo",value:function(e){this._metronome.tempo=e}},{key:"setSignature",value:function(e){this._metronome.signature=e}},{key:"setSignatureVisual",value:function(e){this._signatureVisual=e}},{key:"setSubdivision",value:function(e){this._metronome.resolutionFactor=e}},{key:"setBarNumberElement",value:function(e){this._barNumberElement=e}}]),e}();function c(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function d(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"Practice",(function(){return u})),n.d(t,"makeSearchableDropDown",(function(){return i.b})),n.d(t,"SearchableDropdown",(function(){return i.a})),n.d(t,"Timer",(function(){return s})),n.d(t,"Metronome",(function(){return o}));var u=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.lastActiveElement=null,this.practiceUrl=t,this.isDirty=!1}var t,n,i;return t=e,(n=[{key:"init",value:function(){var e=this;main.startTabsWithContent(),document.addEventListener("click",(function(){return e.__removeFocus()})),document.getElementById("submit-practice-form").addEventListener("click",(function(){return e.savePractice()})),document.getElementById("delete-practice-button").addEventListener("click",(function(){return e.deletePractice()})),Object.values(document.getElementsByClassName("add-row")).forEach((function(t){return e.__addNodeListener(t)})),Object.values(document.getElementsByClassName("remove-row")).forEach((function(t){return e.__removeNodeListener(t)})),Array.from(document.getElementsByClassName("input-change")).forEach((function(t){return t.addEventListener("change",(function(t){return e.listener(t)}))})),document.addEventListener("keyup",(function(t){return e.listener(t)})),this.mobileExericesUl=document.getElementById("practice-exercises-mobile"),this.mobileExericesUl.removeChild(this.mobileExericesUl.lastElementChild)}},{key:"savePractice",value:function(){var e=this;this.isDirty&&fetch(new Request(this.practiceUrl,{method:"POST",mode:"same-origin",body:new FormData(document.getElementById("practice-form"))})).then((function(e){return e.json()})).then((function(t){toast({message:t.toast,type:"is-info",animate:{in:"fadeIn",out:"fadeOut"}}),e.isDirty=!1}))}},{key:"deletePractice",value:function(){confirm("Are you sure you want to delete this practice session?")&&fetch(new Request(this.practiceUrl,{method:"DELETE",mode:"same-origin",headers:{"X-CSRFToken":main.getCsrfToken()}})).then((function(e){return window.location.replace(e.url)}))}},{key:"listener",value:function(e){var t=e.altKey,n=e.code;if(this.isDirty=!0,t&&"KeyS"===n)this.savePractice();else if(t&&"Delete"===n)this.deletePractice();else if("Enter"===n){for(var i=e.srcElement;i=i.parentElement;)if(["UL","TABLE"].includes(i.tagName)){var r=this.__getOtherContainer(i.id);this.__addEntry(r),this.__addEntry(i);break}}else"Tab"===n?this.__removeFocus():(["TEXTAREA","INPUT"].includes(e.target.tagName)||"change"===e.type)&&(this.__getOtherElement(e.srcElement.id).value=e.target.value)}},{key:"__addEntry",value:function(e){if("UL"===e.tagName&&"practice-exercises-mobile"===e.id){this.__removeFocus();var t=e.lastElementChild.cloneNode(!0);t.children[0].children[0].textContent="".concat(Number(t.children[0].children[0].textContent.split(".")[0])+1,"."),this.__updateTextInput(t.children[0].children[1]),this.__updateCellInput(t.children[1].children[0].children[0].children[0].children[1]),this.__updateCellInput(t.children[1].children[0].children[0].children[1].children[1]),this.__updateCellInput(t.children[1].children[0].children[0].children[2].children[1]),e.appendChild(document.createElement("hr")),e.appendChild(t),this.__focusElement(t.children[0].children[1]),this.__removeNodeListener(t.children[0].children[2])}else if("UL"===e.tagName){this.__removeFocus();var n=e.lastElementChild.cloneNode(!0),i=n.children[1].children[0];this.__updateTextInput(i),e.appendChild(n),this.__focusElement(i),this.__removeNodeListener(n.lastElementChild)}else if("TABLE"===e.tagName){this.__removeFocus();var r=e.tBodies[0].lastElementChild.cloneNode(!0);r.children[0].textContent="".concat(Number(r.children[0].textContent.split(".")[0])+1,"."),this.__updateTextInput(r.children[1].children[0]),this.__updateCellInput(r.children[2].children[0]),this.__updateCellInput(r.children[3].children[0]),this.__updateCellInput(r.children[4].children[0]),e.tBodies[0].appendChild(r),this.__focusElement(r.children[1].children[0]),this.__removeNodeListener(r.children[5].children[0])}}},{key:"__focusElement",value:function(e){e.focus(),e.className+=" is-focused",this.lastActiveElement=e}},{key:"__removeFocus",value:function(){this.lastActiveElement&&(this.lastActiveElement.classList.remove("is-focused"),this.lastActiveElement=null)}},{key:"__getOtherElement",value:function(e){return e.includes("mobile")?document.getElementById(e.replace("id_mobile-","id_")):document.getElementById(e.replace("id_","id_mobile-"))}},{key:"__getOtherContainer",value:function(e){return e.includes("mobile")?document.getElementById(e.replace("-mobile","")):document.getElementById("".concat(e,"-mobile"))}},{key:"__addNodeListener",value:function(e){var t=this;e.addEventListener("click",(function(e){for(var n=e.srcElement;"HEADER"!==n.tagName;)n=n.parentElement;"UL"!==(n=n.parentElement.children[1].children[0].children[0]).tagName&&(n=n.children[0]),t.__addEntry(n),t.__addEntry(t.__getOtherContainer(n.id)),t.isDirty=!0}))}},{key:"__removeNodeListener",value:function(e){var t=this;e.addEventListener("click",(function(e){var n=e.srcElement.parentElement.parentElement;["LI","TR"].includes(n.tagName)||"DIV"===(n=n.parentElement).tagName&&(n=n.parentElement);var i=c(n.parentNode.children).indexOf(n),r=t.__getOtherContainer(n.parentElement.id);if(null===r&&(r=t.__getOtherContainer(n.parentElement.parentElement.id)),("TABLE"===n.tagName||"TABLE"===r.tagName)&&"practice-exercises"===r.id){var a=0;if(0!==i){var l=!0,s=!1,o=void 0;try{for(var d,u=n.parentElement.children[Symbol.iterator]();!(l=(d=u.next()).done);l=!0)"HR"===d.value.tagName&&a++}catch(e){s=!0,o=e}finally{try{l||null==u.return||u.return()}finally{if(s)throw o}}}i-=a,r=r.tBodies[0]}t.__removeNode(n),t.__removeNode(r.children[i])}))}},{key:"__removeNode",value:function(e){var t=e.parentElement.children;if(1!==t.length){var n=c(e.parentNode.children).indexOf(e);if(e.parentElement.classList.contains("mobile")&&"DIV"===e.children[0].tagName){for(var i=e.parentElement.children,r=n;r<t.length;r+=2){var a=t[r];a.children[0].children[0].textContent="".concat(Number(a.children[0].children[0].textContent.split(".")[0])-1,"."),this.__updateTextInput(a.children[0].children[1],!0,!1),this.__updateCellInput(a.children[1].children[0].children[0].children[0].children[1],!0,!1,!1),this.__updateCellInput(a.children[1].children[0].children[0].children[1].children[1],!0,!1,!1),this.__updateCellInput(a.children[1].children[0].children[0].children[2].children[1],!0,!1,!1)}var l=0===n?i[n+1]:i[n-1];e.parentElement.removeChild(l),e.parentElement.removeChild(e)}else{for(var s=n;s<t.length;s++){var o=t[s];"LI"===o.tagName?this.__updateTextInput(o.children[1].children[0],!0,!1):(o.children[0].textContent="".concat(Number(o.children[0].textContent.split(".")[0])-1,"."),this.__updateTextInput(o.children[1].children[0],!0,!1,!1),this.__updateCellInput(o.children[2].children[0],!0,!1,!1),this.__updateCellInput(o.children[3].children[0],!0,!1,!1),this.__updateCellInput(o.children[4].children[0],!0,!1,!1))}e.parentElement.removeChild(e)}this.isDirty=!0}else"LI"===e.tagName?"DIV"===e.children[0].tagName?(e.children[0].children[1].value="",e.children[1].children[0].children[0].children[0].children[1].value=60,e.children[1].children[0].children[0].children[1].children[1].value=60,e.children[1].children[0].children[0].children[2].children[1].value=5):e.children[1].children[0].value="":(e.children[1].children[0].value="",e.children[2].children[0].value=60,e.children[3].children[0].value=60,e.children[4].children[0].value=5)}},{key:"__updateTextInput",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=this.__createNewId(e.id,t);e.id=i,e.name=i.split("_").slice(1).join("_"),n&&(e.value="")}},{key:"__updateCellInput",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=this.__createNewId(e.id,t);e.id=r,e.name=r.split("_").slice(1).join("_"),i&&(e.value=e.defaultValue),!e.hasAttribute("min")&&n&&(e.value="")}},{key:"__createNewId",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.split("_");return n[2]=t?Number(n[2])-1:Number(n[2])+1,n.join("_")}},{key:"exitConfirmation",value:function(){return this.isDirty?"There are unsaved changes. All your changes will be lost if you exit.":(this.isDirty=!1,null)}}])&&d(t.prototype,n),i&&d(t,i),e}()}}));